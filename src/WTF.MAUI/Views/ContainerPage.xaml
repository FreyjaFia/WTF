<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:WTF.MAUI.ViewModels"
             x:Class="WTF.MAUI.Views.ContainerPage"
             x:DataType="vm:ContainerViewModel"
             Shell.NavBarIsVisible="False"
             BackgroundColor="#FCF8F1">
    
    <Grid ColumnDefinitions="Auto,*" BackgroundColor="#FCF8F1">
        <!-- Sidebar -->
        <Grid Grid.Column="0"
              BackgroundColor="#FCF8F1"
              Padding="8,16"
              WidthRequest="{Binding SidebarWidth}"
              RowDefinitions="Auto,*,Auto,Auto">
            
            <!-- Top: Nav buttons -->
            <VerticalStackLayout Grid.Row="0" Spacing="0">
                <!-- Home Button -->
                <Border BackgroundColor="Transparent"
                        Stroke="Transparent"
                        StrokeThickness="0"
                        HeightRequest="48"
                        Margin="0,4,8,0"
                        Padding="0"
                        StrokeShape="RoundRectangle 8">
                    <Border.Triggers>
                        <DataTrigger TargetType="Border" Binding="{Binding CurrentPage}" Value="MainPage">
                            <Setter Property="BackgroundColor" Value="#E0E0E0" />
                        </DataTrigger>
                    </Border.Triggers>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding NavigateHomeCommand}" />
                    </Border.GestureRecognizers>
                    <HorizontalStackLayout Spacing="12" Padding="8,0" VerticalOptions="Center">
                        <Label Text="&#xe871;"
                               FontFamily="MaterialIconsOutlined"
                               FontSize="24"
                               TextColor="#1F1F1F"
                               VerticalOptions="Center">
                            <Label.Triggers>
                                <DataTrigger TargetType="Label" Binding="{Binding CurrentPage}" Value="MainPage">
                                    <Setter Property="FontAttributes" Value="Bold" />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                        <Label Text="Home"
                               FontSize="16"
                               TextColor="#1F1F1F"
                               VerticalOptions="Center"
                               IsVisible="{Binding IsSidebarExtended}">
                            <Label.Triggers>
                                <DataTrigger TargetType="Label" Binding="{Binding CurrentPage}" Value="MainPage">
                                    <Setter Property="FontAttributes" Value="Bold" />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                    </HorizontalStackLayout>
                </Border>
                
                <!-- Orders Button -->
                <Border BackgroundColor="Transparent"
                        Stroke="Transparent"
                        StrokeThickness="0"
                        HeightRequest="48"
                        Margin="0,4,8,0"
                        Padding="0"
                        StrokeShape="RoundRectangle 8">
                    <Border.Triggers>
                        <DataTrigger TargetType="Border" Binding="{Binding CurrentPage}" Value="OrderPage">
                            <Setter Property="BackgroundColor" Value="#E0E0E0" />
                        </DataTrigger>
                    </Border.Triggers>
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding NavigateOrdersCommand}" />
                    </Border.GestureRecognizers>
                    <HorizontalStackLayout Spacing="12" Padding="8,0" VerticalOptions="Center">
                        <Label Text="&#xE8CC;"
                               FontFamily="MaterialIconsOutlined"
                               FontSize="24"
                               TextColor="#1F1F1F"
                               VerticalOptions="Center">
                            <Label.Triggers>
                                <DataTrigger TargetType="Label" Binding="{Binding CurrentPage}" Value="OrderPage">
                                    <Setter Property="FontAttributes" Value="Bold" />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                        <Label Text="Orders"
                               FontSize="16"
                               TextColor="#1F1F1F"
                               VerticalOptions="Center"
                               IsVisible="{Binding IsSidebarExtended}">
                            <Label.Triggers>
                                <DataTrigger TargetType="Label" Binding="{Binding CurrentPage}" Value="OrderPage">
                                    <Setter Property="FontAttributes" Value="Bold" />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                    </HorizontalStackLayout>
                </Border>
            </VerticalStackLayout>
            
            <!-- Spacer -->
            <BoxView Grid.Row="1"  BackgroundColor="Transparent" />
            
            <!-- Bottom: Logout Button -->
            <Grid Grid.Row="2" HeightRequest="48" Margin="0,4" ColumnDefinitions="*,Auto">
                <Border Grid.Column="0" 
                        Grid.ColumnSpan="{Binding IsSidebarExtended, Converter={StaticResource BoolToIntConverter}}"
                        BackgroundColor="Transparent"
                        Stroke="Transparent"
                        StrokeThickness="0"
                        Padding="0">
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding LogoutCommand}" />
                    </Border.GestureRecognizers>
                    <HorizontalStackLayout Spacing="12" Padding="8,0" VerticalOptions="Center">
                        <Label Text="&#xe9ba;"
                               FontFamily="MaterialIconsOutlined"
                               FontSize="24"
                               TextColor="#1F1F1F"
                               VerticalOptions="Center" />
                        <Label Text="Logout"
                               FontSize="16"
                               TextColor="#1F1F1F"
                               VerticalOptions="Center"
                               IsVisible="{Binding IsSidebarExtended}" />
                    </HorizontalStackLayout>
                </Border>
                
                <!-- Toggle Button (right of logout when extended) -->
                <Button Grid.Column="1"
                        Text="{Binding SidebarToggleIcon}"
                        FontFamily="MaterialIconsOutlined"
                        Command="{Binding ToggleSidebarCommand}"
                        BackgroundColor="Transparent"
                        BorderColor="Transparent"
                        BorderWidth="0"
                        TextColor="#1F1F1F"
                        FontSize="20"
                        WidthRequest="48"
                        HeightRequest="48"
                        IsVisible="{Binding IsSidebarExtended}" />
            </Grid>
            
            <!-- Toggle Button at bottom (when collapsed) -->
            <Button Grid.Row="3"
                    Text="{Binding SidebarToggleIcon}"
                    FontFamily="MaterialIconsOutlined"
                    Command="{Binding ToggleSidebarCommand}"
                    BackgroundColor="Transparent"
                    BorderColor="Transparent"
                    BorderWidth="0"
                    TextColor="#1F1F1F"
                    FontSize="20"
                    HeightRequest="48"
                    Margin="0,4,0,0"
                    IsVisible="{Binding IsSidebarExtended, Converter={StaticResource InverseBoolConverter}}" />
            <!-- Right border for aesthetics -->
            <BoxView Grid.Row="0"
                     Grid.RowSpan="4"
                     WidthRequest="1"
                     Color="#D0D0D0"
                     HorizontalOptions="End"
                     VerticalOptions="Fill" />
        </Grid>
        
        <!-- Main Content Area - Content swapped here without animation -->
        <ContentPresenter Grid.Column="1"
                          x:Name="MainContentPresenter"
                          BackgroundColor="#FCF8F1" />
    </Grid>
</ContentPage>
